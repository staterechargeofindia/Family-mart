<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ISI â€“ Online Store</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="css/style.css">
</head>

<body>

<!-- ================= SIDE MENU ================= -->
<div id="menu" class="side-menu">
  <a href="profile.html">My Profile</a>
  <a href="cart.html">My Cart</a>
  <a href="merchant.html"><b>Merchant</b></a>
  <a href="admin.html"><b>Admin</b></a>
</div>

<!-- ================= HEADER ================= -->
<header>
  <span id="menuBtn" style="font-size:22px;cursor:pointer;">â˜°</span>
  <b>ISI</b>
  <a href="cart.html">ðŸ›’ <span id="cartCount">0</span></a>
</header>

<!-- ================= PRODUCT LIST ================= -->
<div class="products" id="productList"></div>

<!-- ================= JS FILES ================= -->
<script src="js/main.js"></script>
<script src="js/cart.js"></script>

<!-- ================= PAGE SCRIPT ================= -->
<script>
const products = JSON.parse(localStorage.getItem("products")) || [];
const box = document.getElementById("productList");

/* NO PRODUCTS */
if (products.length === 0) {
  box.innerHTML = `
    <div class="card">
      No products available.<br>
      Merchant please publish products.
    </div>
  `;
}

/* SHOW PRODUCTS */
products.forEach(p => {
  box.innerHTML += `
    <div class="card-product">

      <!-- IMAGE 1 -->
      <img src="${p.images?.[0] || 'assets/placeholder.png'}"
           onclick="zoomImage('${p.images?.[0] || 'assets/placeholder.png'}')">

      <!-- IMAGE 2 -->
      <img src="${p.images?.[1] || 'assets/placeholder.png'}"
           style="margin-top:6px"
           onclick="zoomImage('${p.images?.[1] || 'assets/placeholder.png'}')">

      <b>${p.name}</b>

      <p style="font-size:13px;color:#555">
        ${p.desc || ""}
      </p>

      <div class="price">
        â‚¹${p.price}
        <del style="color:#888">â‚¹${p.mrp}</del>
        <span style="color:green;font-size:13px">
          ${p.discount}% OFF
        </span>
      </div>

      <button onclick="addToCart('${p.name}', ${p.price}, '${p.merchant}')">
        Add to Cart
      </button>

      <small style="display:block;margin-top:6px">
        Sold by ${p.merchant}
      </small>

    </div>
  `;
});

/* UPDATE CART COUNT */
if (typeof updateCartCount === "function") {
  updateCartCount();
}

/* IMAGE ZOOM (FULL SCREEN) */
function zoomImage(src) {
  const overlay = document.createElement("div");
  overlay.style = `
    position:fixed;
    top:0;left:0;
    width:100%;height:100%;
    background:rgba(0,0,0,0.9);
    display:flex;
    align-items:center;
    justify-content:center;
    z-index:9999;
  `;

  overlay.innerHTML = `
    <img src="${src}" style="max-width:95%;max-height:95%">
  `;

  overlay.onclick = () => document.body.removeChild(overlay);
  document.body.appendChild(overlay);
}
</script>

</body>
</html>
