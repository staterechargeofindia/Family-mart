<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ISI â€“ Home</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body style="margin:0;font-family:Arial;background:#f1f3f6">

<!-- ================= SIDE MENU ================= -->
<div id="menu" style="
position:fixed;
top:0;left:-260px;
width:250px;height:100%;
background:#fff;
z-index:9999;
padding:15px;
transition:0.3s;
box-shadow:2px 0 10px rgba(0,0,0,0.2)
">
  <h3>Menu</h3>
  <a href="profile.html">My Profile</a><br><br>
  <a href="my-orders.html">My Orders</a><br><br>
  <a href="cart.html">My Cart</a><br><br>
  <a href="merchant.html">Merchant</a><br><br>
  <a href="admin.html">Admin</a>
</div>

<!-- ================= HEADER ================= -->
<header style="
display:flex;
align-items:center;
justify-content:space-between;
padding:12px;
background:#2874f0;
color:white
">
  <span onclick="toggleMenu()" style="font-size:22px;cursor:pointer">â˜°</span>
  <b>ISI</b>
  <span onclick="location.href='cart.html'" style="font-size:22px;cursor:pointer">
    ðŸ›’ <span id="cartCount">0</span>
  </span>
</header>

<!-- ================= PRODUCTS ================= -->
<div style="padding:10px" id="productList"></div>

<script>
/* MENU */
function toggleMenu(){
  const m = document.getElementById("menu");
  m.style.left = (m.style.left === "0px") ? "-260px" : "0px";
}

/* CART COUNT */
function updateCartCount(){
  const cart = JSON.parse(localStorage.getItem("cart")) || [];
  document.getElementById("cartCount").innerText = cart.length;
}
updateCartCount();

/* PRODUCTS */
const products = JSON.parse(localStorage.getItem("products")) || [];
const box = document.getElementById("productList");

if(products.length === 0){
  box.innerHTML = `
    <div style="background:#fff;padding:15px;border-radius:10px">
      No products available.<br>
      Merchant please publish products.
    </div>
  `;
}

/* RENDER PRODUCTS */
products.forEach((p, index) => {
  box.innerHTML += `
    <div style="
      background:#fff;
      margin-bottom:12px;
      padding:10px;
      border-radius:10px;
      box-shadow:0 2px 6px rgba(0,0,0,0.1)
    ">

      <!-- MANUAL SLIDER -->
      <div class="slider">
        <img src="${p.images[0]}" class="slide active" id="img1-${index}"
          onclick="zoomImage('${p.images[0]}')">
        <img src="${p.images[1]}" class="slide" id="img2-${index}"
          onclick="zoomImage('${p.images[1]}')">

        <span class="nav left" onclick="prevImg(${index})">â€¹</span>
        <span class="nav right" onclick="nextImg(${index})">â€º</span>
      </div>

      <b>${p.name}</b>

      <p style="font-size:13px;color:#555">
        ${p.desc}
      </p>

      <div>
        <b>â‚¹${p.price}</b>
        <del style="color:#888">â‚¹${p.mrp}</del>
        <span style="color:green;font-size:13px">
          ${p.discount}% OFF
        </span>
      </div>

      <button onclick="addToCart('${p.name}', ${p.price}, '${p.merchant}')"
        style="
          width:100%;
          padding:10px;
          background:#2874f0;
          color:white;
          border:none;
          border-radius:6px;
          margin-top:8px
        ">
        Add to Cart
      </button>

      <small style="display:block;margin-top:6px">
        Sold by ${p.merchant}
      </small>

    </div>
  `;
});

/* MANUAL SLIDER LOGIC (2 IMAGES) */
function nextImg(i){
  document.getElementById(`img1-${i}`).classList.toggle("active");
  document.getElementById(`img2-${i}`).classList.toggle("active");
}
function prevImg(i){
  nextImg(i);
}

/* ZOOM IMAGE */
function zoomImage(src){
  const overlay = document.createElement("div");
  overlay.style = `
    position:fixed;
    top:0;left:0;
    width:100%;height:100%;
    background:rgba(0,0,0,0.9);
    display:flex;
    align-items:center;
    justify-content:center;
    z-index:10000;
  `;
  overlay.innerHTML = `
    <img src="${src}" style="max-width:95%;max-height:95%">
  `;
  overlay.onclick = ()=>document.body.removeChild(overlay);
  document.body.appendChild(overlay);
}

/* ADD TO CART */
function addToCart(name, price, merchant){
  const cart = JSON.parse(localStorage.getItem("cart")) || [];
  cart.push({name, price, merchant});
  localStorage.setItem("cart", JSON.stringify(cart));
  updateCartCount();
  alert("Added to cart");
}
</script>

<style>
.slider{
  position:relative;
  height:160px;
  overflow:hidden;
  border-radius:8px;
  margin-bottom:8px;
}
.slide{
  position:absolute;
  width:100%;
  height:160px;
  object-fit:cover;
  display:none;
}
.slide.active{
  display:block;
}
.nav{
  position:absolute;
  top:50%;
  transform:translateY(-50%);
  background:rgba(0,0,0,0.5);
  color:white;
  font-size:22px;
  padding:6px 10px;
  cursor:pointer;
  border-radius:50%;
}
.nav.left{ left:8px; }
.nav.right{ right:8px; }
</style>

</body>
</html>
