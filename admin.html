<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ISI ‚Äì Admin Panel</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="css/style.css">
</head>

<body>

<!-- ================= HEADER ================= -->
<header style="display:flex;align-items:center;justify-content:space-between;
padding:12px;background:#2874f0;color:white">

  <span onclick="history.back()" style="font-size:22px;cursor:pointer">‚¨ÖÔ∏è</span>
  <b>Admin Panel</b>
  <span onclick="location.href='index.html'" style="font-size:22px;cursor:pointer">üè†</span>

</header>

<!-- ================= ADMIN SETTINGS ================= -->
<div class="container">

  <!-- UPI SETTINGS -->
  <div class="card">
    <h3>Payment Settings</h3>
    <p style="font-size:13px;color:#555">
      Change UPI ID (used for all online payments)
    </p>
    <input id="upiInput" placeholder="Enter Admin UPI ID">
    <button onclick="saveUPI()">Save UPI ID</button>
  </div>

  <!-- ORDERS -->
  <div class="card">
    <h3>All Orders</h3>
    <div id="ordersBox"></div>
  </div>

</div>

<!-- ================= SCRIPT ================= -->
<script>
/* ================= ADMIN SETTINGS ================= */
const adminData = JSON.parse(localStorage.getItem("admin")) || {};
const upiField = document.getElementById("upiInput");

upiField.value = adminData.upi || "paytmgr5m9yhroptys";

function saveUPI(){
  localStorage.setItem("admin", JSON.stringify({
    upi: upiField.value
  }));
  alert("UPI ID updated successfully");
}

/* ================= ORDERS ================= */
let orders = JSON.parse(localStorage.getItem("orders")) || [];
const box = document.getElementById("ordersBox");

function renderOrders(){
  box.innerHTML = "";

  if(orders.length === 0){
    box.innerHTML = "<p>No orders found</p>";
    return;
  }

  orders.forEach((order, index) => {

    box.innerHTML += `
      <div class="card ${order.status === 'Delivered' ? 'delivered' : ''}">
        
        <b>Order ID:</b> ${order.id}<br><br>

        <b>Customer Details</b><br>
        Name: ${order.customer?.name || ""}<br>
        Mobile: ${order.customer?.mobile || ""}<br><br>

        <b>Delivery Address</b><br>
        ${order.address?.house || ""} ${order.address?.street || ""}<br>
        ${order.address?.village || ""}, ${order.address?.district || ""}<br>
        ${order.address?.state || ""} - ${order.address?.pincode || ""}<br>
        ${order.address?.address || ""}<br><br>

        <b>Payment Method:</b> ${order.payment}<br>
        <b>Status:</b> ${order.status}<br><br>

        <b>Ordered Products</b><br>
        ${order.items.map(i => `
          ${i.name} ‚Äì ‚Çπ${i.price}
          <small>(Merchant: ${i.merchant})</small>
        `).join("<br>")}
        <br><br>

        ${
          order.status !== "Delivered"
          ? `<button onclick="confirmDelivered(${index})">
               Confirm Delivered
             </button>`
          : `<span style="color:green;font-weight:bold">
               ‚úî Order Delivered
             </span>`
        }

      </div>
    `;
  });
}

function confirmDelivered(i){
  if(!confirm("Confirm this order as Delivered?")) return;

  orders[i].status = "Delivered";
  localStorage.setItem("orders", JSON.stringify(orders));
  renderOrders();
}

renderOrders();
</script>

</body>
</html>
