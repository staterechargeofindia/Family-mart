<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Checkout</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="style.css">
</head>

<body>

<header>
  <span onclick="history.back()">â†</span>
  <b>Checkout</b>
  <span onclick="location.href='index.html'">ğŸ </span>
</header>

<div class="container">

  <div class="card">
    <h3>Product Details</h3>
    <p>Selected product from cart</p>
  </div>

  <div class="card">
    <h3>Delivery Address</h3>
    <div id="primaryAddr"></div>
    <button onclick="location.href='manage-address.html'">
      Manage Address
    </button>
  </div>

  <div class="card">
    <h3>Payment Method</h3>
    <div id="cod" class="method active" onclick="selectPay('cod')">
      ğŸ’µ Cash on Delivery
    </div>
    <div id="upi" class="method" onclick="selectPay('upi')">
      ğŸ“± UPI Payment
    </div>
    <div id="upiBox">
      <img src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=upi://pay?pa=paytmgr5m9yhroptys">
    </div>
  </div>

  <div class="card">
    <button onclick="placeOrder()">Place Order</button>
  </div>

</div>

<div id="successBox">
  <div class="popup">
    <h2>ğŸ‰ Order Successful</h2>
    <p>Your order has been placed successfully</p>
    <button onclick="location.href='index.html'">Go Home</button>
  </div>
</div>

<script>
let pay="cod";

function selectPay(t){
  pay=t;
  cod.classList.remove("active");
  upi.classList.remove("active");
  document.getElementById(t).classList.add("active");
  upiBox.style.display = t==="upi"?"block":"none";
}

const addresses = JSON.parse(localStorage.getItem("addresses")) || [];
const primary = addresses.find(a=>a.primary);

if(primary){
  primaryAddr.innerHTML = `
    <b>${primary.name}</b><br>
    ${primary.mobile}<br>
    ${primary.address}<br>
    ${primary.district}, ${primary.state} - ${primary.pincode}
  `;
}else{
  primaryAddr.innerHTML = "<span style='color:red'>No primary address selected</span>";
}

function placeOrder(){
  if(!primary){
    alert("Please select primary address");
    return;
  }
  successBox.style.display="flex";
}
</script>

</body>
</html>
