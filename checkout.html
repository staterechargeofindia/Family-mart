<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ISI ‚Äì Checkout</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="css/style.css">
</head>

<body>

<!-- ================= HEADER ================= -->
<header style="display:flex;align-items:center;justify-content:space-between;
padding:12px;background:#2874f0;color:white">

  <span onclick="history.back()" style="font-size:22px;cursor:pointer">‚¨ÖÔ∏è</span>
  <b>Checkout</b>
  <span onclick="location.href='index.html'" style="font-size:22px;cursor:pointer">üè†</span>

</header>

<!-- ================= CONTENT ================= -->
<div class="container">

  <!-- ADDRESS -->
  <div class="card">
    <h3>Delivery Address</h3>
    <p id="addressBox"></p>
    <button onclick="editAddress()" style="background:#ddd;color:#000">
      Edit Address
    </button>
  </div>

  <!-- PAYMENT -->
  <div class="card">
    <h3>Select Payment Method</h3>

    <button onclick="selectPayment('COD')">Cash on Delivery</button><br><br>
    <button onclick="selectPayment('UPI')">UPI</button><br><br>
    <button onclick="selectPayment('DEBIT')">Debit Card</button><br><br>
    <button onclick="selectPayment('CREDIT')">Credit Card</button>
  </div>

  <!-- PAYMENT DETAILS -->
  <div class="card" id="paymentBox" style="display:none"></div>

  <!-- PLACE ORDER -->
  <button onclick="placeOrder()">Confirm Order</button>

</div>

<!-- ================= SCRIPT ================= -->
<script>
const profile = JSON.parse(localStorage.getItem("profile")) || {};
const cart = JSON.parse(localStorage.getItem("cart")) || [];
const orders = JSON.parse(localStorage.getItem("orders")) || [];

let selectedPayment = "COD";
const upiId = "paytmgr5m9yhroptys";

/* SHOW ADDRESS */
document.getElementById("addressBox").innerHTML = `
<b>${profile.name || ""}</b><br>
${profile.mobile || ""}<br>
${profile.house || ""} ${profile.street || ""}<br>
${profile.village || ""}, ${profile.district || ""}<br>
${profile.state || ""} - ${profile.pincode || ""}<br>
${profile.address || ""}
`;

function editAddress(){
  location.href = "profile.html";
}

/* PAYMENT SELECT */
function selectPayment(type){
  selectedPayment = type;
  const box = document.getElementById("paymentBox");
  box.style.display = "block";

  if(type === "COD"){
    box.innerHTML = "<p>Pay when product is delivered.</p>";
  }

  if(type === "UPI"){
    box.innerHTML = `
      <p>Pay via UPI</p>
      <b>${upiId}</b><br><br>
      <a href="upi://pay?pa=${upiId}&pn=ISI&cu=INR">
        <button>Pay with PhonePe / GPay / Paytm</button>
      </a>
    `;
  }

  if(type === "DEBIT" || type === "CREDIT"){
    box.innerHTML = `
      <input placeholder="Card Number">
      <input placeholder="Name on Card">
      <input placeholder="Expiry MM/YY">
      <input placeholder="CVV">
      <p style="font-size:12px;color:#777">Demo only</p>
    `;
  }
}

/* PLACE ORDER */
function placeOrder(){
  if(cart.length === 0){
    alert("Cart is empty");
    return;
  }

  orders.push({
    id: "ORD-" + Date.now(),
    customer: profile,
    address: profile,
    items: cart,
    payment: selectedPayment,
    status: "New",
    createdAt: new Date().toLocaleString()
  });

  localStorage.setItem("orders", JSON.stringify(orders));
  localStorage.removeItem("cart");

  alert("Order placed successfully");
  location.href = "index.html";
}
</script>

</body>
</html>
